{"version":3,"sources":["node.js"],"names":["_toConsumableArray","arr","Array","isArray","i","arr2","length","from","$","$$","_","Mavo","Node","Class","abstract","constructor","element","mavo","o","arguments","undefined","Error","this","template","copies","push","fromTemplate","property","getProperty","type","Group","normalize","store","getAttribute","group","parentGroup","hooks","run","isRoot","name","readable","toLowerCase","data","getData","saved","walk","callback","walker","obj","ret","propagate","walkUp","call","_len","args","_key","apply","concat","edit","preEdit","propagated","toJSON","prototype","_len2","properties","_key2","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","value","err","static","create","_Mavo$Unit","is","collection","Collection","Unit","hasAttribute","id","classList","setAttribute","Bliss"],"mappings":"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","file":"mavo.min.js","sourcesContent":["(function($, $$) {\n\nvar _ = Mavo.Node = $.Class({\n\tabstract: true,\n\tconstructor: function (element, mavo, o = {}) {\n\t\tif (!element || !mavo) {\n\t\t\tthrow new Error(\"Mavo.Node constructor requires an element argument and a mavo object\");\n\t\t}\n\n\t\tthis.element = element;\n\t\tthis.template = o.template;\n\n\t\tif (this.template) {\n\t\t\t// TODO remove if this is deleted\n\t\t\tthis.template.copies.push(this);\n\t\t}\n\t\telse {\n\t\t\tthis.copies = [];\n\t\t}\n\n\t\tthis.mavo = mavo;\n\n\t\tif (!this.fromTemplate(\"property\", \"type\")) {\n\t\t\tthis.property = _.getProperty(element);\n\t\t\tthis.type = Mavo.Group.normalize(element);\n\t\t\tthis.store = this.element.getAttribute(\"data-store\");\n\t\t}\n\n\t\tthis.group = this.parentGroup = o.group;\n\n\t\tMavo.hooks.run(\"node-init-end\", this);\n\t},\n\n\tget isRoot() {\n\t\treturn !this.property;\n\t},\n\n\tget name() {\n\t\treturn Mavo.readable(this.property || this.type).toLowerCase();\n\t},\n\n\tget data() {\n\t\treturn this.getData();\n\t},\n\n\tget saved() {\n\t\treturn this.store !== \"none\";\n\t},\n\n\twalk: function(callback) {\n\t\tvar walker = obj => {\n\t\t\tvar ret = callback(obj);\n\n\t\t\tif (ret !== false) {\n\t\t\t\tobj.propagate && obj.propagate(walker);\n\t\t\t}\n\t\t};\n\n\t\twalker(this);\n\t},\n\n\twalkUp: function(callback) {\n\t\tvar group = this;\n\n\t\twhile (group = group.parentGroup) {\n\t\t\tvar ret = callback(group);\n\n\t\t\tif (ret !== undefined) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\t},\n\n\tcall: function(callback, ...args) {\n\t\targs = args || [];\n\n\t\tif (typeof callback === \"string\") {\n\t\t\treturn this[callback](...args);\n\t\t}\n\t\telse {\n\t\t\treturn callback.apply(this, [this, ...args]);\n\t\t}\n\t},\n\n\tedit: function() {\n\t\tthis.propagate(obj => obj[obj.preEdit? \"preEdit\" : \"edit\"]());\n\t},\n\n\tpropagated: [\"save\", \"revert\", \"done\", \"import\"],\n\n\ttoJSON: Mavo.prototype.toJSON,\n\n\tfromTemplate: function(...properties) {\n\t\tif (this.template) {\n\t\t\tfor (let property of properties) {\n\t\t\t\tthis[property] = this.template[property];\n\t\t\t}\n\t\t}\n\n\t\treturn !!this.template;\n\t},\n\n\tstatic: {\n\t\tcreate: function(element, mavo, o = {}) {\n\t\t\tif (Mavo.is(\"multiple\", element) && !o.collection) {\n\t\t\t\treturn new Mavo.Collection(element, mavo, o);\n\t\t\t}\n\n\t\t\treturn Mavo.Unit.create(...arguments);\n\t\t},\n\n\t\t/**\n\t\t * Get & normalize property name, if exists\n\t\t */\n\t\tgetProperty: function(element) {\n\t\t\tvar property = element.getAttribute(\"property\") || element.getAttribute(\"itemprop\");\n\n\t\t\tif (!property && element.hasAttribute(\"property\")) {\n\t\t\t\tproperty = element.name || element.id || element.classList[0];\n\t\t\t}\n\n\t\t\tif (property) {\n\t\t\t\telement.setAttribute(\"property\", property);\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n"],"sourceRoot":"/source/"}