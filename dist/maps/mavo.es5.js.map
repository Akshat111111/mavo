{"version":3,"sources":["storage.github.js"],"names":[],"mappings":"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","file":"mavo.es5.js","sourcesContent":["(function($) {\n\nif (!self.Mavo) {\n\treturn;\n}\n\nvar _ = Mavo.Storage.Backend.register($.Class({\n\textends: Mavo.Storage.Backend,\n\tid: \"Github\",\n\tconstructor: function() {\n\t\tthis.permissions.on(\"login\");\n\n\t\tthis.key = this.storage.param(\"key\") || \"7e08e016048000bc594e\";\n\n\t\t// Extract info for username, repo, branch, filepath from URL\n\t\tthis.url = new URL(this.url, location);\n\t\t$.extend(this, _.parseURL(this.url));\n\t\tthis.repo = this.repo || \"mv-data\";\n\t\tthis.branch = this.branch || \"master\";\n\t\tthis.path = this.path || `${this.mavo.id}.json`;\n\n\t\tthis.permissions.on(\"read\"); // TODO check if file actually is publicly readable\n\n\t\tthis.login(true);\n\t},\n\n\tget authenticated () {\n\t\treturn !!this.accessToken;\n\t},\n\n\t/**\n\t * Helper method to make a request with the Github API\n\t */\n\treq: function(call, data, method = \"GET\", o = {method: method}) {\n\t\tif (data) {\n\t\t\to.data =  JSON.stringify(data);\n\t\t}\n\n\t\tvar request = $.extend(o, {\n\t\t\tresponseType: \"json\"\n\t\t});\n\n\t\tif (this.authenticated) {\n\t\t\trequest.headers = {\n\t\t\t\t\"Authorization\": `token ${this.accessToken}`\n\t\t\t};\n\t\t}\n\n\t\treturn $.fetch(\"https://api.github.com/\" + call, request)\n\t\t.catch(err => {\n\t\t\tif (err && err.xhr) {\n\t\t\t\treturn Promise.reject(err.xhr);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconsole.error(err);\n\t\t\t\tconsole.log(err.stack);\n\t\t\t}\n\t\t})\n\t\t.then(xhr => Promise.resolve(xhr.response));\n\t},\n\n\tget: function() {\n\t\treturn this.req(`repos/${this.username}/${this.repo}/contents/${this.path}`)\n\t\t       .then(response => Promise.resolve(_.atob(response.content)));\n\t},\n\n\t/**\n\t * Saves a file to the backend.\n\t * @param {Object} file - An object with name & data keys\n\t * @return {Promise} A promise that resolves when the file is saved.\n\t */\n\tput: function(file = this.getFile()) {\n\t\tvar fileCall = `repos/${this.username}/${this.repo}/contents/${file.path}`;\n\n\t\treturn Promise.resolve(this.repoInfo || this.req(\"user/repos\", {\n\t\t\tname: this.repo\n\t\t}, \"POST\"))\n\t\t.then(repoInfo => {\n\t\t\tthis.repoInfo = repoInfo;\n\n\t\t\treturn this.req(fileCall, {\n\t\t\t\tref: this.branch\n\t\t\t});\n\t\t})\n\t\t.then(fileInfo => {\n\t\t\treturn this.req(fileCall, {\n\t\t\t\tmessage: `Updated ${file.name || \"file\"}`,\n\t\t\t\tcontent: _.btoa(file.dataString),\n\t\t\t\tbranch: this.branch,\n\t\t\t\tsha: fileInfo.sha\n\t\t\t}, \"PUT\");\n\t\t}, xhr => {\n\t\t\tif (xhr.status == 404) {\n\t\t\t\t// File does not exist, create it\n\t\t\t\treturn this.req(fileCall, {\n\t\t\t\t\tmessage: \"Created file\",\n\t\t\t\t\tcontent: _.btoa(file.dataString),\n\t\t\t\t\tbranch: this.branch\n\t\t\t\t}, \"PUT\");\n\t\t\t}\n\t\t\t// TODO include time out\n\t\t}).then(data => {\n\t\t\tconsole.log(\"success\");\n\t\t\treturn file;\n\t\t});\n\t},\n\n\tlogin: function(passive) {\n\t\treturn this.ready.then(() => {\n\t\t\tif (this.authenticated) {\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn (new Promise((resolve, reject) => {\n\t\t\t\tif (passive) {\n\t\t\t\t\tthis.accessToken = localStorage[\"mavo:githubtoken\"];\n\n\t\t\t\t\tif (this.accessToken) {\n\t\t\t\t\t\tresolve(this.accessToken);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Show window\n\t\t\t\t\tvar popup = {\n\t\t\t\t\t\twidth: Math.min(1000, innerWidth - 100),\n\t\t\t\t\t\theight: Math.min(800, innerHeight - 100)\n\t\t\t\t\t};\n\n\t\t\t\t\tpopup.top = (innerHeight - popup.height)/2 + (screen.top || screenTop);\n\t\t\t\t\tpopup.left = (innerWidth - popup.width)/2 + (screen.left || screenLeft);\n\n\t\t\t\t\tthis.authPopup = open(`https://github.com/login/oauth/authorize?client_id=${this.key}&scope=repo,gist&state=${location.href}`,\n\t\t\t\t\t\t\"popup\", `width=${popup.width},height=${popup.height},left=${popup.left},top=${popup.top}`);\n\n\t\t\t\t\taddEventListener(\"message\", evt => {\n\t\t\t\t\t\tif (evt.source === this.authPopup) {\n\t\t\t\t\t\t\tthis.accessToken = localStorage[\"mavo:githubtoken\"] = evt.data;\n\n\t\t\t\t\t\t\tif (!this.accessToken) {\n\t\t\t\t\t\t\t\treject(Error(\"Authentication error\"));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve(this.accessToken);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}))\n\t\t\t.then(() => this.getUser())\n\t\t\t.catch(xhr => {\n\t\t\t\tif (xhr.status == 401) {\n\t\t\t\t\t// Unauthorized. Access token we have is invalid, discard it\n\t\t\t\t\tthis.logout();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(u => {\n\t\t\t\tif (this.user) {\n\t\t\t\t\tthis.permissions.on(\"logout\");\n\n\t\t\t\t\treturn this.req(`repos/${this.username}/${this.repo}`)\n\t\t\t\t\t\t.then(repoInfo => {\n\t\t\t\t\t\t\tthis.repoInfo = repoInfo;\n\n\t\t\t\t\t\t\tif (repoInfo.permissions.push) {\n\t\t\t\t\t\t\t\tthis.permissions.on([\"edit\", \"save\"]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(xhr => {\n\t\t\t\t\t\t\tif (xhr.status == 404) {\n\t\t\t\t\t\t\t\t// Repo does not exist so we can't check permissions\n\t\t\t\t\t\t\t\t// Just check if authenticated user is the same as our URL username\n\t\t\t\t\t\t\t\tif (this.user.login.toLowerCase() == this.username.toLowerCase()) {\n\t\t\t\t\t\t\t\t\tthis.permissions.on([\"edit\", \"save\"]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t},\n\n\tlogout: function() {\n\t\tif (this.authenticated) {\n\t\t\tlocalStorage.removeItem(\"mavo:githubtoken\");\n\t\t\tdelete this.accessToken;\n\n\t\t\tthis.permissions.off([\"edit\", \"add\", \"delete\", \"save\"]).on(\"login\");\n\n\t\t\tthis.mavo.wrapper._.fire(\"mavo:logout\", {backend: this});\n\t\t}\n\n\t\treturn Promise.resolve();\n\t},\n\n\tgetUser: function() {\n\t\treturn this.req(\"user\").then(accountInfo => {\n\t\t\tthis.user = accountInfo;\n\n\t\t\tvar name = accountInfo.name || accountInfo.login;\n\t\t\t$.fire(this.mavo.wrapper, \"mavo:login\", {\n\t\t\t\tbackend: this,\n\t\t\t\tname: `<a href=\"https://github.com/${accountInfo.login}\" target=\"_blank\">\n\t\t\t\t\t\t\t<img class=\"avatar\" src=\"${accountInfo.avatar_url}\" /> ${name}\n\t\t\t\t\t\t</a>`\n\t\t\t});\n\t\t});\n\t},\n\n\tstatic: {\n\t\ttest: function(url) {\n\t\t\turl = new URL(url, location);\n\t\t\treturn /\\bgithub.(com|io)|raw.githubusercontent.com/.test(url.host);\n\t\t},\n\n\t\t/**\n\t\t * Parse Github URLs, return username, repo, branch, path\n\t\t */\n\t\tparseURL: function(url) {\n\t\t\tvar ret = {};\n\n\t\t\turl = new URL(url, location);\n\n\t\t\tvar path = url.pathname.slice(1).split(\"/\");\n\n\t\t\tif (/github.io$/.test(url.host)) {\n\t\t\t\tret.username = url.host.match(/([\\w-]+)\\.github\\.io$/)[1];\n\n\t\t\t\tif (path.length == 1) {\n\t\t\t\t\t// Heuristic to tell apart username.github.io repos from\n\t\t\t\t\t// other gh-pages repos. This is impossible to figure out without a request.\n\t\t\t\t\t// E.g. username.github.io/foo/bar.json could be either repo = username.github.io, path = foo/bar.json\n\t\t\t\t\t// or repo = foo, path = bar.json\n\t\t\t\t\tret.repo = url.host;\n\t\t\t\t\tret.path = path[0];\n\t\t\t\t\tret.branch = \"master\";\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tret.branch = \"gh-pages\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tret.username = path.shift();\n\t\t\t}\n\n\t\t\tret.repo = path.shift();\n\n\t\t\tif (/raw.githubusercontent.com$/.test(url.host)) {\n\t\t\t\tret.branch = path.shift();\n\t\t\t}\n\t\t\telse if (/github.com$/.test(url.host) && path[0] == \"blob\") {\n\t\t\t\tpath.shift();\n\t\t\t\tret.branch = path.shift();\n\t\t\t}\n\n\t\t\tret.path = path.join(\"/\");\n\n\t\t\treturn ret;\n\t\t},\n\n\t\t// Fix atob() and btoa() so they can handle Unicode\n\t\tbtoa: str => btoa(unescape(encodeURIComponent(str))),\n\t\tatob: str => decodeURIComponent(escape(window.atob(str)))\n\t}\n}));\n\n})(Bliss);\n"],"sourceRoot":"/source/"}