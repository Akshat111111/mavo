{"version":3,"sources":["node.js"],"names":[],"mappings":"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","file":"mavo.es5.js","sourcesContent":["(function($, $$) {\n\nvar _ = Mavo.Node = $.Class({\n\tabstract: true,\n\tconstructor: function (element, mavo, o = {}) {\n\t\tif (!element || !mavo) {\n\t\t\tthrow new Error(\"Mavo.Node constructor requires an element argument and a mavo object\");\n\t\t}\n\n\t\tthis.element = element;\n\t\tthis.template = o.template;\n\n\t\tif (this.template) {\n\t\t\t// TODO remove if this is deleted\n\t\t\tthis.template.copies.push(this);\n\t\t}\n\t\telse {\n\t\t\tthis.copies = [];\n\t\t}\n\n\t\tthis.mavo = mavo;\n\n\t\tif (!this.fromTemplate(\"property\", \"type\")) {\n\t\t\tthis.property = _.getProperty(element);\n\t\t\tthis.type = Mavo.Group.normalize(element);\n\t\t\tthis.store = this.element.getAttribute(\"data-store\");\n\t\t}\n\n\t\tthis.group = this.parentGroup = o.group;\n\n\t\tMavo.hooks.run(\"node-init-end\", this);\n\t},\n\n\tget isRoot() {\n\t\treturn !this.property;\n\t},\n\n\tget name() {\n\t\treturn Mavo.readable(this.property || this.type).toLowerCase();\n\t},\n\n\tget data() {\n\t\treturn this.getData();\n\t},\n\n\tget saved() {\n\t\treturn this.store !== \"none\";\n\t},\n\n\twalk: function(callback) {\n\t\tvar walker = obj => {\n\t\t\tvar ret = callback(obj);\n\n\t\t\tif (ret !== false) {\n\t\t\t\tobj.propagate && obj.propagate(walker);\n\t\t\t}\n\t\t};\n\n\t\twalker(this);\n\t},\n\n\twalkUp: function(callback) {\n\t\tvar group = this;\n\n\t\twhile (group = group.parentGroup) {\n\t\t\tvar ret = callback(group);\n\n\t\t\tif (ret !== undefined) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\t},\n\n\tcall: function(callback, ...args) {\n\t\targs = args || [];\n\n\t\tif (typeof callback === \"string\") {\n\t\t\treturn this[callback](...args);\n\t\t}\n\t\telse {\n\t\t\treturn callback.apply(this, [this, ...args]);\n\t\t}\n\t},\n\n\tedit: function() {\n\t\tthis.propagate(obj => obj[obj.preEdit? \"preEdit\" : \"edit\"]());\n\t},\n\n\tpropagated: [\"save\", \"revert\", \"done\", \"import\"],\n\n\ttoJSON: Mavo.prototype.toJSON,\n\n\tfromTemplate: function(...properties) {\n\t\tif (this.template) {\n\t\t\tfor (let property of properties) {\n\t\t\t\tthis[property] = this.template[property];\n\t\t\t}\n\t\t}\n\n\t\treturn !!this.template;\n\t},\n\n\tstatic: {\n\t\tcreate: function(element, mavo, o = {}) {\n\t\t\tif (Mavo.is(\"multiple\", element) && !o.collection) {\n\t\t\t\treturn new Mavo.Collection(element, mavo, o);\n\t\t\t}\n\n\t\t\treturn Mavo.Unit.create(...arguments);\n\t\t},\n\n\t\t/**\n\t\t * Get & normalize property name, if exists\n\t\t */\n\t\tgetProperty: function(element) {\n\t\t\tvar property = element.getAttribute(\"property\") || element.getAttribute(\"itemprop\");\n\n\t\t\tif (!property && element.hasAttribute(\"property\")) {\n\t\t\t\tproperty = element.name || element.id || element.classList[0];\n\t\t\t}\n\n\t\t\tif (property) {\n\t\t\t\telement.setAttribute(\"property\", property);\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t}\n});\n\n})(Bliss, Bliss.$);\n"],"sourceRoot":"/source/"}