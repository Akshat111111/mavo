{"version":3,"sources":["mavo.js"],"names":[],"mappings":"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","file":"mavo.es5.js","sourcesContent":["(function ($, $$) {\n\n\"use strict\";\n\nvar _ = self.Mavo = $.Class({\n\tconstructor: function (element) {\n\t\t// Index among other mavos in the page, 1 is first\n\t\tthis.index = _.all.push(this);\n\n\t\t// Assign a unique (for the page) id to this mavo instance\n\t\tthis.id = element.getAttribute(\"data-mavo\") || Mavo.Node.getProperty(element) || element.id || `mavo${this.index}`;\n\n\t\tthis.unhandled = element.classList.contains(\"mv-keep-unhandled\");\n\n\t\tif (this.index == 1) {\n\t\t\tthis.store = _.urlParam(\"store\");\n\t\t\tthis.source = _.urlParam(\"source\");\n\t\t}\n\n\t\tthis.store = this.store || _.urlParam(`${this.id}_store`) || element.getAttribute(\"data-store\") || null;\n\t\tthis.source = this.source || _.urlParam(`${this.id}_source`) || element.getAttribute(\"data-source\") || null;\n\n\t\tthis.autoEdit = _.has(\"autoedit\", element);\n\n\t\tthis.element = _.is(\"scope\", element)? element : $(_.selectors.rootScope, element);\n\n\t\tif (!this.element) {\n\t\t\telement.setAttribute(\"typeof\", element.getAttribute(\"property\") || \"\");\n\t\t\telement.removeAttribute(\"property\");\n\t\t\tthis.element = element;\n\t\t}\n\n\t\tthis.element.classList.add(\"mv-root\");\n\n\t\t// Apply heuristic for collections\n\t\t$$(_.selectors.property + \", \" + _.selectors.scope, element).concat([this.element]).forEach(element => {\n\t\t\tif (_.is(\"autoMultiple\", element) && !element.hasAttribute(\"data-multiple\")) {\n\t\t\t\telement.setAttribute(\"data-multiple\", \"\");\n\t\t\t}\n\t\t});\n\n\t\tthis.wrapper = element.closest(\".mv-wrapper\") || element;\n\n\t\t// Ctrl + S or Cmd + S to save\n\t\tthis.wrapper.addEventListener(\"keydown\", evt => {\n\t\t\tif (evt.keyCode == 83 && evt[_.superKey]) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tthis.save();\n\t\t\t}\n\t\t});\n\n\t\t// Apply heuristic for scopes\n\t\t$$(_.selectors.primitive, element).forEach(element => {\n\t\t\tvar isScope = $(`${_.selectors.not(_.selectors.formControl)}, ${_.selectors.property}`, element) && (// Contains other properties or non-form elements and...\n\t\t\t                Mavo.is(\"multiple\", element) || // is a collection...\n\t\t\t                Mavo.Primitive.getValueAttribute(element) === null  // ...or its content is not in an attribute\n\t\t\t\t\t\t) || element.matches(\"template\");\n\n\t\t\tif (isScope) {\n\t\t\t\telement.setAttribute(\"typeof\", \"\");\n\t\t\t}\n\t\t});\n\n\t\tif (this.wrapper === this.element && _.is(\"multiple\", element)) {\n\t\t\t// Need to create a wrapper\n\t\t\tvar around = this.element;\n\n\t\t\t// Avoid producing invalid HTML\n\t\t\tif (this.element.matches(\"li, option\")) {\n\t\t\t\taround = around.parentNode;\n\t\t\t}\n\t\t\telse if (this.element.matches(\"td, tr, tbody, thead, tfoot\")) {\n\t\t\t\taround = around.closest(\"table\");\n\t\t\t}\n\n\t\t\tthis.wrapper = $.create({ around });\n\t\t}\n\n\t\tthis.wrapper.classList.add(\"mv-wrapper\");\n\n\t\tthis.ui = {\n\t\t\tbar: $(\".mv-bar\", this.wrapper) || $.create({\n\t\t\t\tclassName: \"mv-bar mv-ui\",\n\t\t\t\tstart: this.wrapper\n\t\t\t})\n\t\t};\n\n\t\tthis.ui.status = $(\".status\", this.ui.bar) || $.create(\"span\", {\n\t\t\tclassName: \"status\",\n\t\t\tinside: this.ui.bar\n\t\t});\n\n\t\t// Is there any control that requires an edit button?\n\t\tthis.needsEdit = false;\n\n\t\tthis.permissions = new Mavo.Permissions(null, this);\n\n\t\t// Build mavo objects\n\t\tMavo.hooks.run(\"init-tree-before\", this);\n\n\t\tthis.root = Mavo.Node.create(this.element, this);\n\n\t\tMavo.hooks.run(\"init-tree-after\", this);\n\n\t\tthis.setUnsavedChanges(false);\n\n\t\t_.observe(this.wrapper, \"class\", () => {\n\t\t\tvar p = this.permissions;\n\t\t\tvar floating = !this.editing && (p.login || p.edit && !p.login && !(p.save && this.unsavedChanges));\n\t\t\tthis.ui.bar.classList.toggle(\"floating\", floating);\n\t\t});\n\n\t\tthis.permissions.onchange(({action, value}) => {\n\t\t\tthis.wrapper.classList.toggle(`can-${action}`, value);\n\t\t});\n\n\t\tthis.permissions.can([\"edit\", \"add\", \"delete\"], () => {\n\t\t\tthis.ui.edit = $.create(\"button\", {\n\t\t\t\tclassName: \"edit\",\n\t\t\t\ttextContent: \"Edit\",\n\t\t\t\tonclick: e => this.editing? this.done() : this.edit(),\n\t\t\t\tinside: this.ui.bar\n\t\t\t});\n\n\t\t\tif (this.autoEdit) {\n\t\t\t\trequestAnimationFrame(() => this.ui.edit.click());\n\t\t\t}\n\t\t}, () => { // cannot\n\t\t\t$.remove(this.ui.edit);\n\n\t\t\tif (this.editing) {\n\t\t\t\tthis.done();\n\t\t\t}\n\t\t});\n\n\t\tif (this.needsEdit) {\n\t\t\tthis.permissions.can(\"save\", () => {\n\t\t\t\tthis.ui.save = $.create(\"button\", {\n\t\t\t\t\tclassName: \"save\",\n\t\t\t\t\ttextContent: \"Save\",\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: e => this.save(),\n\t\t\t\t\t\t\"mouseenter focus\": e => {\n\t\t\t\t\t\t\tthis.wrapper.classList.add(\"save-hovered\");\n\t\t\t\t\t\t\tthis.setUnsavedChanges();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mouseleave blur\": e => this.wrapper.classList.remove(\"save-hovered\")\n\t\t\t\t\t},\n\t\t\t\t\tinside: this.ui.bar\n\t\t\t\t});\n\n\t\t\t\tthis.ui.revert = $.create(\"button\", {\n\t\t\t\t\tclassName: \"revert\",\n\t\t\t\t\ttextContent: \"Revert\",\n\t\t\t\t\tdisabled: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: e => this.revert(),\n\t\t\t\t\t\t\"mouseenter focus\": e => {\n\t\t\t\t\t\t\tif (!this.unsavedChanges) {\n\t\t\t\t\t\t\t\tthis.wrapper.classList.add(\"revert-hovered\");\n\t\t\t\t\t\t\t\tthis.setUnsavedChanges();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mouseleave blur\": e => this.wrapper.classList.remove(\"revert-hovered\")\n\t\t\t\t\t},\n\t\t\t\t\tinside: this.ui.bar\n\t\t\t\t});\n\t\t\t}, () => {\n\t\t\t\t$.remove([this.ui.save, this.ui.revert]);\n\t\t\t\tthis.ui.save = this.ui.revert = null;\n\t\t\t});\n\t\t}\n\n\t\tthis.permissions.can(\"delete\", () => {\n\t\t\tthis.ui.clear = $.create(\"button\", {\n\t\t\t\tclassName: \"clear\",\n\t\t\t\ttextContent: \"Clear\",\n\t\t\t\tonclick: e => this.clear()\n\t\t\t});\n\n\t\t\tthis.ui.bar.appendChild(this.ui.clear);\n\t\t});\n\n\t\tthis.permissions.cannot([\"delete\", \"edit\"], () => {\n\t\t\t$.remove(this.ui.clear);\n\t\t});\n\n\t\tif (this.store || this.source) {\n\t\t\t// Fetch existing data\n\t\t\tthis.storage = new _.Storage(this);\n\n\t\t\tthis.permissions.can(\"read\", () => this.storage.load());\n\t\t}\n\t\telse {\n\t\t\t// No storage\n\t\t\tthis.permissions.on([\"read\", \"edit\"]);\n\n\t\t\t$.fire(this.wrapper, \"mavo:load\");\n\t\t}\n\n\t\tif (!this.needsEdit) {\n\t\t\tthis.permissions.off([\"edit\", \"add\", \"delete\"]);\n\t\t}\n\n\t\tMavo.hooks.run(\"init-end\", this);\n\t},\n\n\tget data() {\n\t\treturn this.getData();\n\t},\n\n\tgetData: function(o) {\n\t\treturn this.root.getData(o);\n\t},\n\n\ttoJSON: function(data = this.data) {\n\t\treturn _.toJSON(data);\n\t},\n\n\trender: function(data) {\n\t\t_.hooks.run(\"render-start\", {context: this, data});\n\n\t\tif (data) {\n\t\t\tthis.root.render(data);\n\t\t}\n\n\t\tthis.unsavedChanges = false;\n\t},\n\n\tclear: function() {\n\t\tif (confirm(\"This will delete all your data. Are you sure?\")) {\n\t\t\tthis.storage && this.storage.clear();\n\t\t\tthis.root.clear();\n\t\t}\n\t},\n\n\tedit: function() {\n\t\tthis.editing = true;\n\n\t\tthis.root.edit();\n\n\t\t$.events(this.wrapper, \"mouseenter.mavo:edit mouseleave.mavo:edit\", evt => {\n\t\t\tif (evt.target.matches(\".mv-item-controls .delete\")) {\n\t\t\t\tvar item = evt.target.closest(_.selectors.item);\n\t\t\t\titem.classList.toggle(\"delete-hover\", evt.type == \"mouseenter\");\n\t\t\t}\n\n\t\t\tif (evt.target.matches(_.selectors.item)) {\n\t\t\t\tevt.target.classList.remove(\"has-hovered-item\");\n\n\t\t\t\tvar parent = evt.target.parentNode.closest(_.selectors.item);\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.classList.toggle(\"has-hovered-item\", evt.type == \"mouseenter\");\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\n\t\tthis.setUnsavedChanges();\n\t},\n\n\tsetUnsavedChanges: function(value) {\n\t\tvar unsavedChanges = !!value;\n\n\t\tif (!value) {\n\t\t\tthis.walk(obj => {\n\t\t\t\tif (obj.unsavedChanges) {\n\t\t\t\t\tunsavedChanges = true;\n\n\t\t\t\t\tif (value === false) {\n\t\t\t\t\t\tobj.unsavedChanges = false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.unsavedChanges = unsavedChanges;\n\t},\n\n\t// Conclude editing\n\tdone: function() {\n\t\tthis.root.done();\n\t\t$.unbind(this.wrapper, \".mavo:edit\");\n\t\tthis.editing = false;\n\t\tthis.unsavedChanges = false;\n\t},\n\n\tsave: function() {\n\t\tthis.root.save();\n\n\t\tif (this.storage) {\n\t\t\tthis.storage.save();\n\t\t}\n\n\t\tthis.unsavedChanges = false;\n\t},\n\n\trevert: function() {\n\t\tthis.root.revert();\n\t},\n\n\twalk: function(callback) {\n\t\tthis.root.walk(callback);\n\t},\n\n\tlive: {\n\t\tediting: {\n\t\t\tset: function(value) {\n\t\t\t\tthis.wrapper.classList.toggle(\"editing\", value);\n\n\t\t\t\tif (value) {\n\t\t\t\t\tthis.wrapper.setAttribute(\"data-editing\", \"\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.wrapper.removeAttribute(\"data-editing\");\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tunsavedChanges: function(value) {\n\t\t\tthis.wrapper.classList.toggle(\"unsaved-changes\", value);\n\n\t\t\tif (this.ui && this.ui.save) {\n\t\t\t\tthis.ui.save.disabled = !value;\n\t\t\t\tthis.ui.revert.disabled = !value;\n\t\t\t}\n\t\t},\n\n\t\tneedsEdit: function(value) {\n\t\t\tthis.ui.bar[`${value? \"remove\" : \"set\"}Attribute`](\"hidden\", \"\");\n\t\t}\n\t},\n\n\tstatic: {\n\t\tall: [],\n\n\t\tsuperKey: navigator.platform.indexOf(\"Mac\") === 0? \"metaKey\" : \"ctrlKey\",\n\n\t\tinit: container => $$(_.selectors.init, container || document).map(element => new _(element)),\n\n\t\thooks: new $.Hooks()\n\t}\n});\n\n{\n\nlet s = _.selectors = {\n\tinit: \".mavo, [mavo], [data-mavo], [data-store]\",\n\tproperty: \"[property], [itemprop]\",\n\tspecificProperty: name => `[property=${name}], [itemprop=${name}]`,\n\tscope: \"[typeof], [itemscope], [itemtype], .mv-group\",\n\tmultiple: \"[multiple], [data-multiple], .multiple\",\n\trequired: \"[required], [data-required], .required\",\n\tformControl: \"input, select, option, textarea\",\n\tcomputed: \".computed\", // Properties or scopes with computed properties, will not be saved\n\titem: \".mv-item\",\n\tui: \".mv-ui\",\n\toption: name => `[${name}], [data-${name}], [data-mv-options~='${name}'], .${name}`,\n\tcontainer: {\n\t\t\"li\": \"ul, ol\",\n\t\t\"tr\": \"table\",\n\t\t\"option\": \"select\",\n\t\t\"dt\": \"dl\",\n\t\t\"dd\": \"dl\"\n\t},\n\tdocumentFragment: \".document-fragment\"\n};\n\nlet arr = s.arr = selector => selector.split(/\\s*,\\s*/g);\nlet not = s.not = selector => arr(selector).map(s => `:not(${s})`).join(\"\");\nlet or = s.or = (selector1, selector2) => selector1 + \", \" + selector2;\nlet and = s.and = (selector1, selector2) => {\n\tvar ret = [], arr2 = arr(selector2);\n\n\tarr(selector1).forEach(s1 => ret.push(...arr2.map(s2 => s1 + s2)));\n\n\treturn ret.join(\", \");\n};\nlet andNot = s.andNot = (selector1, selector2) => and(selector1, not(selector2));\n\n$.extend(_.selectors, {\n\tprimitive: andNot(s.property, s.scope),\n\trootScope: andNot(s.scope, s.property),\n\toutput: or(s.specificProperty(\"output\"), \".output, .value\"),\n\tautoMultiple: and(\"li, tr, option\", \":only-of-type\")\n});\n\n}\n\n// Init mavo\nPromise.all([\n\t$.ready(),\n\t$.include(Array.from && window.Intl && document.documentElement.closest, \"https://cdn.polyfill.io/v2/polyfill.min.js?features=blissfuljs,Intl.~locale.en\")\n])\n.catch(err => console.error(err))\n.then(() => Mavo.init());\n\nStretchy.selectors.filter = \".mv-editor:not([property])\";\n\n})(Bliss, Bliss.$);\n"],"sourceRoot":"/source/"}